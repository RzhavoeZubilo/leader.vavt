{"version":3,"sources":["../src/infobanner.js"],"names":["define","$","str","ModalFactory","ModalEvents","Notification","initInfoBanner","showconfirmationdialogue","stringsPromise","get_strings","key","component","modalPromise","create","type","types","SAVE_CANCEL","click","event","stopPropagation","when","then","strings","modal","setTitle","setBody","setSaveButtonText","getRoot","on","save","M","util","set_user_preference","alert","show","fail","exception","init"],"mappings":"AAuBAA,OAAM,iCAAC,CAAC,QAAD,CAAW,UAAX,CAAuB,oBAAvB,CAA6C,mBAA7C,CAAkE,mBAAlE,CAAD,CACF,SAASC,CAAT,CAAYC,CAAZ,CAAiBC,CAAjB,CAA+BC,CAA/B,CAA4CC,CAA5C,CAA0D,CAC1D,aAOA,QAASC,CAAAA,CAAT,CAAwBC,CAAxB,CAAkD,IAgB1CC,CAAAA,CAAc,CAAGN,CAAG,CAACO,WAAJ,CAdQ,CACzB,CACIC,GAAG,CAAE,cADT,CAEIC,SAAS,CAAE,oBAFf,CADyB,CAItB,CACCD,GAAG,CAAE,4BADN,CAECC,SAAS,CAAE,oBAFZ,CAJsB,CAOtB,CACCD,GAAG,CAAE,WADN,CAECC,SAAS,CAAE,oBAFZ,CAPsB,CAcR,CAhByB,CAiB1CC,CAAY,CAAGT,CAAY,CAACU,MAAb,CAAoB,CAACC,IAAI,CAAEX,CAAY,CAACY,KAAb,CAAmBC,WAA1B,CAApB,CAjB2B,CAoB9Cf,CAAC,CAAC,wCAAD,CAAD,CAA4CgB,KAA5C,CAAkD,SAASC,CAAT,CAAgB,CAE9DA,CAAK,CAACC,eAAN,GAEA,GAAgC,GAA5B,EAAAZ,CAAJ,CAAqC,CACjCN,CAAC,CAACmB,IAAF,CAAOZ,CAAP,CAAuBI,CAAvB,EAAqCS,IAArC,CAA0C,SAASC,CAAT,CAAkBC,CAAlB,CAAyB,CAC/DA,CAAK,CAACC,QAAN,CAAeF,CAAO,CAAC,CAAD,CAAtB,EACAC,CAAK,CAACE,OAAN,CAAcH,CAAO,CAAC,CAAD,CAArB,EACAC,CAAK,CAACG,iBAAN,CAAwBJ,CAAO,CAAC,CAAD,CAA/B,EAEAC,CAAK,CAACI,OAAN,GAAgBC,EAAhB,CAAmBxB,CAAW,CAACyB,IAA/B,CAAqC,UAAW,CAC5CC,CAAC,CAACC,IAAF,CAAOC,mBAAP,CAA2B,yCAA3B,KAEA/B,CAAC,CAAC,iCAAD,CAAD,CAAqCgC,KAArC,CAA2C,OAA3C,CACH,CAJD,EAKAV,CAAK,CAACW,IAAN,GACA,MAAOX,CAAAA,CACV,CAZD,EAYGY,IAZH,CAYQ9B,CAAY,CAAC+B,SAZrB,CAaH,CAdD,IAcO,CACHN,CAAC,CAACC,IAAF,CAAOC,mBAAP,CAA2B,yCAA3B,KAEA/B,CAAC,CAAC,iCAAD,CAAD,CAAqCgC,KAArC,CAA2C,OAA3C,CACH,CACJ,CAvBD,CAwBH,CAED,MAAO,CACHI,IAAI,CAAE,cAAS9B,CAAT,CAAmC,CACrCD,CAAc,CAACC,CAAD,CACjB,CAHE,CAKV,CA5DK,CAAN","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Theme Boost Campus - JS code for feature information banner\n *\n * @module     theme_boost_campus/infobanner\n * @copyright  2020 Kathrin Osswald, Ulm University <kathrin.osswald@uni-ulm.de>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\ndefine(['jquery', 'core/str', 'core/modal_factory', 'core/modal_events', 'core/notification'],\n    function($, str, ModalFactory, ModalEvents, Notification) {\n    \"use strict\";\n\n    /**\n     * Initialising.\n     *\n     * @param {string} showconfirmationdialogue\n     */\n    function initInfoBanner(showconfirmationdialogue) {\n\n        var stringsforInfoBannerJS = [\n            {\n                key: 'confirmation',\n                component: 'theme_boost_campus'\n            }, {\n                key: 'closingperpetualinfobanner',\n                component: 'theme_boost_campus'\n            }, {\n                key: 'yes_close',\n                component: 'theme_boost_campus'\n            }\n        ];\n\n        // Load the strings and modal before clicking on the button so that the confirmation dialogue can pop up faster.\n        var stringsPromise = str.get_strings(stringsforInfoBannerJS);\n        var modalPromise = ModalFactory.create({type: ModalFactory.types.SAVE_CANCEL});\n\n        // With this we store the dismissing of the info banner as a user preference to persist this decision.\n        $('#themeboostcampusperpinfobanner .close').click(function(event) {\n            // Stop propagation to keep the info banner there until the decision in the confirmation dialogue has been made.\n            event.stopPropagation();\n\n            if (showconfirmationdialogue == '1') {\n                $.when(stringsPromise, modalPromise).then(function(strings, modal) {\n                    modal.setTitle(strings[0]);\n                    modal.setBody(strings[1]);\n                    modal.setSaveButtonText(strings[2]);\n                    // Saved clicked - the dismissing of the info banner is confirmed.\n                    modal.getRoot().on(ModalEvents.save, function() {\n                        M.util.set_user_preference('theme_boost_campus_infobanner_dismissed', true);\n                        // Now close the alert.\n                        $('#themeboostcampusperpinfobanner').alert('close');\n                    });\n                    modal.show();\n                    return modal;\n                }).fail(Notification.exception);\n            } else {\n                M.util.set_user_preference('theme_boost_campus_infobanner_dismissed', true);\n                // Now close the alert.\n                $('#themeboostcampusperpinfobanner').alert('close');\n            }\n        });\n    }\n\n    return {\n        init: function(showconfirmationdialogue) {\n            initInfoBanner(showconfirmationdialogue);\n        }\n    };\n});\n"],"file":"infobanner.min.js"}